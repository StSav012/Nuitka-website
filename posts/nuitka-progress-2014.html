<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/">
    <link rel="icon" href="../_static/favicon.svg" type="image/svg+xml">
    <link rel="icon" href="../_static/favicon.png" sizes="32x32" type="image/png">
    <link rel="icon" href="../_static/favicon.ico" sizes="32x32" type="image/x-icon">
    <link rel="icon" href="../_static/apple-touch-icon-iphone.png" sizes="57x57" type="image/png">
    <link rel="icon" href="../_static/apple-touch-icon-ipad.png" sizes="72x72" type="image/png">
    <link rel="icon" href="../_static/apple-touch-icon-iphone4.png" sizes="114x114" type="image/png">
    <link rel="icon" href="../_static/apple-touch-icon-ipad3.png" sizes="144x144" type="image/png">
    <link rel="apple-touch-icon" href="../_static/apple-touch-icon-180x180.png" sizes="180x180" type="image/png">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nuitka progress 2014 &#8212; Nuitka the Python Compiler  documentation</title>
      <link rel="stylesheet" href="/_static/css/combined_e6840a1efaf0bb3afd9a2fd6b30cc2e9.css" type="text/css">
      <link rel="canonical" href="https://nuitka.net/posts/nuitka-progress-2014.html">
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script>var DOCUMENTATION_OPTIONS = {
    URL_ROOT: '../',
    VERSION: '',
    LANGUAGE: 'en',
    COLLAPSE_INDEX: false,
    BUILDER: 'html',
    FILE_SUFFIX: '.html',
    LINK_SUFFIX: '.html',
    HAS_SOURCE: false,
    SOURCELINK_SUFFIX: '.txt',
    NAVIGATION_WITH_KEYS: false,
    SHOW_SEARCH_SUMMARY: true,
    ENABLE_SEARCH_SHORTCUTS: true,
};</script>
        <script src="/_static/combined_1f3d291568f0d25fd5e0e83c3075a3a3.js" async=""></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js" async=""></script>
        <script src="../_static/clipboard.min.js" async=""></script>
        <script src="../_static/copybutton.js" async=""></script>
        <link rel="index" title="Index" href="../genindex.html">
    <link rel="alternate" type="application/atom+xml" href="../blog/atom.xml" title="Nuitka Blog">
 
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../index.html" class="icon icon-home"> Nuitka the Python Compiler
            <div class="logo_container"><img src="../_static/Nuitka-Logo-Symbol.svg" class="logo" alt="Logo" width="208" height="209">
          </div></a><!-- Empty override file take the place of searchbox.html, which generates search box. -->
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/download.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/user-manual.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/support.html">Support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Commercial Users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/commercial.html">Nuitka Commercial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/bundles.html">Nuitka Bundles</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Release Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/Changelog.html">Nuitka Release 1.2 (Draft)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/Changelog.html#nuitka-release-1-1">Nuitka Release 1.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/Changelog.html#nuitka-release-1-0">Nuitka Release 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/Changelog.html#older-releases">Older Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/roadmap.html">Roadmap</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/developer-manual.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/api-doc.html">API doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/factory.html">Factory Instructions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Media</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pages/Presentations.html">Presentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/Streaming.html">Streaming</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/Credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/impressum.html">Impressum</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Under construction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/welcome.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/pyside2.html">Nuitka PySide2 support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/donations.html">Donations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/gsoc2019.html">Google Summer of Code 2019</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Nuitka the Python Compiler</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <!-- Empty override file take the place of sphinx_rtd_theme/breadcrumbs.html, which generates the top nav breadcrumbs. -->
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
              <section id="nuitka-progress-2014">
<h1><a class="toc-backref" href="#id1">Nuitka progress 2014</a><a class="headerlink" href="#nuitka-progress-2014" title="Permalink to this heading">&#61633;</a></h1>
<p>Again, not much has happened publicly to Nuitka, except for some
releases, so it&#8217;s time to make a kind of status post, about the really
exciting news there is, also looking back at 2014 for Nuitka, and
forward of course.</p>
<p>I meant to post this basically since last year, but never got around to
it, therefore the 2014 in the title.</p>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#nuitka-progress-2014" id="id1">Nuitka progress 2014</a></p>
<ul>
<li><p><a class="reference internal" href="#ssa-single-state-assignment-form" id="id2">SSA (Single State Assignment Form)</a></p></li>
<li><p><a class="reference internal" href="#improved-code-generation" id="id3">Improved Code Generation</a></p></li>
<li><p><a class="reference internal" href="#scalability" id="id4">Scalability</a></p></li>
<li><p><a class="reference internal" href="#compatibility" id="id5">Compatibility</a></p>
<ul>
<li><p><a class="reference internal" href="#cells-for-closure" id="id6">Cells for Closure</a></p></li>
<li><p><a class="reference internal" href="#local-variable-storage" id="id7">Local Variable Storage</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#performance" id="id8">Performance</a></p>
<ul>
<li><p><a class="reference internal" href="#graphs-and-benchmarks" id="id9">Graphs and Benchmarks</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#standalone" id="id10">Standalone</a></p></li>
<li><p><a class="reference internal" href="#other-stuff" id="id11">Other Stuff</a></p>
<ul>
<li><p><a class="reference internal" href="#funding" id="id12">Funding</a></p></li>
<li><p><a class="reference internal" href="#collaborators" id="id13">Collaborators</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#future" id="id14">Future</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="ssa-single-state-assignment-form">
<h2><a class="toc-backref" href="#id2">SSA (Single State Assignment Form)</a><a class="headerlink" href="#ssa-single-state-assignment-form" title="Permalink to this heading">&#61633;</a></h2>
<p>For a long, long time already, each release of Nuitka has worked towards
enabling <a class="reference external" href="http://en.wikipedia.org/wiki/Static_single_assignment_form" target="_blank">&#8220;SSA&#8221;</a> usage in
Nuitka. There is a component called &#8220;constraint collection&#8221;, which is
tasked with driving the optimization, and collecting variable traces.</p>
<p>Based on these traces, optimizations can be made. Having SSA or not, is
(to me) the difference between Nuitka as a compiler, and Nuitka as an
optimizing compiler.</p>
<p>The news is, SSA has carried the day, and is used throughout code
generation for some time now, and gave minor improvements. It has been
applied to the temporary and local variable values.</p>
<p>And currently, work is on the way to expand it to module and shared
variables, which can get invalidated quite easily, as soon as unknown
code is executed. An issue there is to identify all those spots
reliably.</p>
<p>And this spring, we are finally going to see the big jump that is
happening, once Nuitka starts to use that information to propagate
things.</p>
<p>Still, right now, this code assigns to a local variable, then reads from
it to return. But not much longer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">a</span>
</pre></div>
</div>
<p>This is going to instantly give gains, and more importantly, will enable
analysis, that leads to avoiding e.g. the creation of function objects
for local functions, being able to in-line, etc.</p>
</section>
<section id="improved-code-generation">
<h2><a class="toc-backref" href="#id3">Improved Code Generation</a><a class="headerlink" href="#improved-code-generation" title="Permalink to this heading">&#61633;</a></h2>
<p>Previously, under the title &#8220;C-ish&#8221;, Nuitka moved away from C++ based
code generation to less C++ based code generated, and more C-ish code.
This trend continues, and has lead to removing more code generation
improvements.</p>
<p>The important change recently was to remove the usage of the blocking
holdouts, the C++ classes used for local variables are closure taking,
and release, and move those to be done manually.</p>
<p>This enabled special code generation for in-place operations, which are
the most significant improvements of the upcoming release. These were
held back on, as with C++ destructors doing the release, it&#8217;s
practically impossible to deal with values suddenly becoming illegal.
Transfer of object ownership needs to be more fluid than could be
presented to C++ objects.</p>
<p>Currently, this allows to speed up string in-place operations, which
very importantly then, can avoid to <code class="docutils literal notranslate"><span class="pre">memcpy</span></code> large values potentially.
And this is about catching up to CPython in this regard. After that, we
will likely be able to expand it to cases where CPython could never do
it, e.g. also <code class="docutils literal notranslate"><span class="pre">int</span></code> objects</p>
</section>
<section id="scalability">
<h2><a class="toc-backref" href="#id4">Scalability</a><a class="headerlink" href="#scalability" title="Permalink to this heading">&#61633;</a></h2>
<p>The scalability of Nuitka depends much on generated code size. With it
being less stupid, the generated code is now not only faster, but
definitely smaller, and with more optimization, it will only become more
practical.</p>
<p>Removing the many C++ classes already gave the backend compiler an
easier time. But we need to do more, to e.g. have generic parameter
parsing, instead of specialized per function, and module exclusive
constants should not be pre-created, but in the module body, when they
are used.</p>
</section>
<section id="compatibility">
<h2><a class="toc-backref" href="#id5">Compatibility</a><a class="headerlink" href="#compatibility" title="Permalink to this heading">&#61633;</a></h2>
<p>There is not a whole lot to gain in the compatibility domain anymore.
Nothing important certainly. But there are these minor things.</p>
<section id="cells-for-closure">
<h3><a class="toc-backref" href="#id6">Cells for Closure</a><a class="headerlink" href="#cells-for-closure" title="Permalink to this heading">&#61633;</a></h3>
<p>However, since we now use <code class="docutils literal notranslate"><span class="pre">PyCell</span></code> objects for closure, we could start
and provide a real <code class="docutils literal notranslate"><span class="pre">__closure__</span></code> value, that could even be writable.
We could start supporting that easily.</p>
</section>
<section id="local-variable-storage">
<h3><a class="toc-backref" href="#id7">Local Variable Storage</a><a class="headerlink" href="#local-variable-storage" title="Permalink to this heading">&#61633;</a></h3>
<p>Currently, local variables use stack storage. Were we to use function
object or frame object attached storage, we could provide frame locals
that actually work. This may be as simple as to put those in an array on
the stack and use the pointer to it.</p>
<p>Suddenly locals would become writable. I am not saying this is useful,
just that it&#8217;s possible to do this.</p>
</section>
</section>
<section id="performance">
<h2><a class="toc-backref" href="#id8">Performance</a><a class="headerlink" href="#performance" title="Permalink to this heading">&#61633;</a></h2>
<section id="graphs-and-benchmarks">
<h3><a class="toc-backref" href="#id9">Graphs and Benchmarks</a><a class="headerlink" href="#graphs-and-benchmarks" title="Permalink to this heading">&#61633;</a></h3>
<p>The work on automated performance graphs has made progress, and they are
supposed to show up on <a class="reference external" href="https://speedcenter.nuitka.net">Nuitka Speedcenter</a> each time, <code class="docutils literal notranslate"><span class="pre">master</span></code>, <code class="docutils literal notranslate"><span class="pre">develop</span></code> or
<code class="docutils literal notranslate"><span class="pre">factory</span></code> git branches change.</p>
<p>There currently is no structure to these graphs. There is no
explanations or comments, and there is no trend indicators. All of which
makes it basically useless to everybody except me. And even harder for
me than necessary.</p>
<p>At least it&#8217;s updated to latest Nikola, and uses PyGal for the graphics
now, so it&#8217;s easier to expand. The plan here, is to integrate with
special pages from a Wiki, making it easy to provide comments.</p>
</section>
</section>
<section id="standalone">
<h2><a class="toc-backref" href="#id10">Standalone</a><a class="headerlink" href="#standalone" title="Permalink to this heading">&#61633;</a></h2>
<p>The standalone mode of Nuitka is pretty good, and as usual it continued
to improve only.</p>
<p>The major improvements came from handling case collisions between
modules and packages. One can have <code class="docutils literal notranslate"><span class="pre">Module.py</span></code> and
<code class="docutils literal notranslate"><span class="pre">module/__init__.py</span></code> and they both are expected to be different, even
on Windows, where filenames are case insensitive.</p>
<p>So, giving up on <code class="docutils literal notranslate"><span class="pre">implib</span></code> and similar, we finally have our own code to
scan in a compatible way the file system, and make these determinations,
whereas library code exposing functionality, doesn&#8217;t handling all things
in really the proper way.</p>
</section>
<section id="other-stuff">
<h2><a class="toc-backref" href="#id11">Other Stuff</a><a class="headerlink" href="#other-stuff" title="Permalink to this heading">&#61633;</a></h2>
<section id="funding">
<h3><a class="toc-backref" href="#id12">Funding</a><a class="headerlink" href="#funding" title="Permalink to this heading">&#61633;</a></h3>
<p>Nuitka receives some, bit not quite enough <a class="reference external" href="/pages/donations.html">donations</a>. There is no support from
organizations like e.g. the PSF, and it seems I better not hold my
breath for it. I will travel to Europython 2015, and would ask you to
support me with that, it&#8217;s going to be expensive.</p>
<p>In 2014, with donations, I bought a &#8220;Cubox i4-Pro&#8221;, which is an ARM
based machine with 4 cores, and 2GB RAM. Works from flash, and with the
eSATA disk attached, it works nice for continuous integration, which
helps me a lot to deliver extremely high quality releases. It&#8217;s pretty
nice, except that when using all 4 cores, it gets too hot. So &#8220;systemd&#8221;
to the rescue and just limited the Buildbot slave&#8217;s service to use 3
cores of CPU maximum and now it runs stable.</p>
<p>Also with donations I bought a Terrabyte SSD, which I use on the desktop
to speed up hosting the virtual machines, and my work in general.</p>
<p>And probably more important, the host of &#8220;nuitka.net&#8221; became a real
machine with real hardware last year, and lots more RAM, so I can spare
myself of optimizing e.g. MySQL for low memory usage. The monthly fee of
that is substantial, but supported from your donations. Thanks a lot!</p>
</section>
<section id="collaborators">
<h3><a class="toc-backref" href="#id13">Collaborators</a><a class="headerlink" href="#collaborators" title="Permalink to this heading">&#61633;</a></h3>
<p>Things are coming along nicely. When I started out, I was fully aware
that the project is something that I can do on my own if necessary, and
that has not changed. Things are going slower than necessary though, but
that&#8217;s probably very typical.</p>
<p>But you can join and should do so now, just <a class="reference external" href="/doc/user-manual.html#join-nuitka">follow this link</a> or become part of
the mailing list (since closed) and help me there with request I make,
e.g. review posts of mine, test out things, pick up small jobs, answer
questions of newcomers, you know the drill probably.</p>
<p>Nuitka is about to make break through progress. And you can be a part of
it. Now.</p>
</section>
</section>
<section id="future">
<h2><a class="toc-backref" href="#id14">Future</a><a class="headerlink" href="#future" title="Permalink to this heading">&#61633;</a></h2>
<p>So, there is multiple things going on:</p>
<ul>
<li><p>More &#8220;C-ish&#8221; code generation</p>
<p>The next release is going to be more &#8220;C-ish&#8221; than before, and we can
start to actually migrate to really &#8220;C&#8221; language. You can help out if
you want to, this is fairly standard cleanups. Just pop up on the
mailing list and say so.</p>
<p>This prong of action is coming to a logical end. The &#8220;C-ish&#8221; project,
while not planned from the outset, turns out to be a full success.
Initially, I would not have started Nuitka, should I have faced the
full complexity of code generation that there is now. So it was good
to start with &#8220;C++&#8221;, but it&#8217;s a better Nuitka now.</p>
</li>
<li><p>More SSA usage</p>
<p>The previous releases consolidated on SSA. A few missing
optimizations were found, because SSA didn&#8217;t realize things, which
were then highlighted by code generation being too good, e.g. not
using exception variables.</p>
<p>We seem to have an SSA that can be fully trusted now, and while it
can be substantially improved (e.g. the <code class="docutils literal notranslate"><span class="pre">try/finally</span></code> removes all
knowledge, although it only needs to do a partial removing of
knowledge for the finally block, not for afterwards at all), it will
already allow for many nice things to happen.</p>
<p>Once we take it to that next level, Nuitka will be able to speed up
some things by much more than the factor it basically has provided
for 2 years now, and it&#8217;s probably going to happen before summer, or
so I hope.</p>
</li>
<li><p>Value propagation</p>
<p>Starting out with simple cases, Nuitka will forward propagate
variable values, and start to eliminate variable usages entirely,
where they are not needed.</p>
<p>That will make many things much more compact, and faster at run time.
We will then try and build &#8220;gates&#8221; for statements that they cannot
pass, so we can e.g. optimize constant things outside of loops, that
kind of thing.</p>
</li>
</ul>
<p>When these 3 things come to term, Nuitka will make a huge step ahead. I
look forward to demoing function call in-lining, or at least avoiding
the argument parsing at EuroPython 2015, making direct calls, which will
be way faster than normal calls.</p>
<p>From then on, a boatload of work remains. The infrastructure in place,
still there is going to be plenty of work to optimize more and more
things conretely.</p>
<p>Let me know, if you are willing to help. I really need that help to make
things happen faster.</p>
</section>
</section>

<div class="section">
    

<div class="section">
  <span style="float: left">
     
    <a href="nuitka-release-059.html">
      <i class="fa fa-arrow-circle-left"></i> Nuitka Release 0.5.9
    </a>
    
  </span>
  <span>&#160;</span>
  <span style="float: right">
     
    <a href="nuitka-release-0510.html">
      Nuitka Release 0.5.10 <i class="fa fa-arrow-circle-right"></i>
    </a>
    
  </span>
</div>
  
</div>

           </div>
          </div>
          <footer>

  <hr>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Kay Hayen and Nuitka Contributors.</p>
  </div>

  
<div class="share-button-container">
    <div class="socialbutton-wrapper">

        <a href="https://twitter.com/share?url=https://nuitka.net/posts/nuitka-progress-2014.html&amp;hashtags=nuitka" target="_blank">
            <div class="socialbutton twitter">
                <p class="icon">
                    <img src="/_static/icon-twitter.png" width="24" height="24">
                </p>

                <p class="shares">share...</p>
            </div>
        </a>

        <a href="https://www.facebook.com/sharer.php?u=https://nuitka.net/posts/nuitka-progress-2014.html&amp;hashtag=%23nuitka" target="_blank">
            <div class="socialbutton facebook">
                <p class="icon">
                    <img src="/_static/icon-facebook.png" width="24" height="24">
                </p>

                <p class="shares">share...</p>
            </div>
        </a>

        <a href="http://www.reddit.com/submit?url=https://nuitka.net/posts/nuitka-progress-2014.html" target="_blank">
            <div class="socialbutton reddit">
                <p class="icon">
                    <img src="/_static/icon-reddit.png" width="24" height="24">
                </p>

                <p class="shares">share...</p>
            </div>
        </a>

        <details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 switcher-container">
            <summary class="sd-summary-title sd-card-header switcher-title">EN<div class="sd-summary-down docutils">
                    <svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewbox="0 0 24 24" aria-hidden="true">
                        <path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z">
                        </path>
                    </svg>
                </div>
                <div class="sd-summary-up docutils">
                    <svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewbox="0 0 24 24" aria-hidden="true">
                        <path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z">
                        </path>
                    </svg>
                </div>
            </summary>
            <div class="sd-summary-content sd-card-body switcher-body docutils">
                <blockquote>
                    <div>
                        <div><div class="line"><a class="reference external" href="/zh_CN/posts/nuitka-progress-2014.html">CN</a></div>
                            <div class="line"><a class="reference external" href="/de_DE/posts/nuitka-progress-2014.html">DE</a></div>
                            </div></div>
                </blockquote>
            </div>
        </details>
    </div>
</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  </body>
</html>