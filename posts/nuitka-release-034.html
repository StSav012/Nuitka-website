<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/">
    <link rel="icon" href="../_static/favicon.svg" type="image/svg+xml">
    <link rel="icon" href="../_static/favicon.png" sizes="32x32" type="image/png">
    <link rel="icon" href="../_static/favicon.ico" sizes="32x32" type="image/x-icon">
    <link rel="icon" href="../_static/apple-touch-icon-iphone.png" sizes="57x57" type="image/png">
    <link rel="icon" href="../_static/apple-touch-icon-ipad.png" sizes="72x72" type="image/png">
    <link rel="icon" href="../_static/apple-touch-icon-iphone4.png" sizes="114x114" type="image/png">
    <link rel="icon" href="../_static/apple-touch-icon-ipad3.png" sizes="144x144" type="image/png">
    <link rel="apple-touch-icon" href="../_static/apple-touch-icon-180x180.png" sizes="180x180" type="image/png">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nuitka Release 0.3.4 &#8212; Nuitka the Python Compiler  documentation</title>
      <link rel="stylesheet" href="/_static/css/combined_03f7eeec2061fd0a5acfc23d1d0bf4fb.css" type="text/css">
      <link rel="canonical" href="https://nuitka.net/posts/nuitka-release-034.html">
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script>var DOCUMENTATION_OPTIONS = {
    URL_ROOT: '../',
    VERSION: '',
    LANGUAGE: 'en',
    COLLAPSE_INDEX: false,
    BUILDER: 'html',
    FILE_SUFFIX: '.html',
    LINK_SUFFIX: '.html',
    HAS_SOURCE: false,
    SOURCELINK_SUFFIX: '.txt',
    NAVIGATION_WITH_KEYS: false,
    SHOW_SEARCH_SUMMARY: true,
    ENABLE_SEARCH_SHORTCUTS: true,
};</script>
        <script src="/_static/combined_50b22e29ca76da059b0c14dcc606bcaa.js" async=""></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js" async=""></script>
        <script src="../_static/sphinx_highlight.js" async=""></script>
        <script src="../_static/clipboard.min.js" async=""></script>
        <script src="../_static/copybutton.js" async=""></script>
        <link rel="index" title="Index" href="../genindex.html">
    <link rel="alternate" type="application/atom+xml" href="../blog/atom.xml" title="Nuitka Blog">



</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">

          
          
          <a href="../index.html" class="icon icon-home">
            Nuitka the Python Compiler
              <div class="logo_container"><img src="../_static/Nuitka-Logo-Symbol.svg" class="logo" alt="Logo" width="208" height="209">
          </div></a><!-- Empty override file take the place of searchbox.html, which generates search box. -->
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/download.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/user-manual.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/support.html">Support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Commercial Users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/commercial.html">Nuitka Commercial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/bundles.html">Nuitka Bundles</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Release Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/Changelog.html">Nuitka Release 1.5 (Draft)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/Changelog.html#nuitka-release-1-4">Nuitka Release 1.4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/Changelog.html#nuitka-release-1-3">Nuitka Release 1.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/Changelog.html#older-releases">Older Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/roadmap.html">Roadmap</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/developer-manual.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/nuitka-package-config.html">Nuitka Package Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/api-doc.html">API doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/factory.html">Factory Instructions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Media</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pages/Presentations.html">Presentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/Streaming.html">Streaming</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/Credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/impressum.html">Impressum</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Under construction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/welcome.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/pyside2.html">Nuitka PySide2 support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/pyqt5.html">Nuitka PyQt5 support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/donations.html">Donations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/gsoc2019.html">Google Summer of Code 2019</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Nuitka the Python Compiler</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <!-- Empty override file take the place of sphinx_rtd_theme/breadcrumbs.html, which generates the top nav breadcrumbs. -->
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
<section id="nuitka-release-0-3-4">
<h1>Nuitka Release 0.3.4<a class="headerlink" href="#nuitka-release-0-3-4" title="Permalink to this heading">&#61633;</a></h1>
<p>This is to inform you about the new stable release of <a class="reference external" href="https://nuitka.net">Nuitka</a>. It is the extremely compatible Python compiler,
<a class="reference external" href="/doc/download.html">&#8220;download now&#8221;</a>.</p>
<p>This new release of Nuitka has a focus on re-organizing the Nuitka
generated source code and a modest improvement on the performance side.</p>
<p>For a long time now, Nuitka has generated a single C++ file and asked
the C++ compiler to translate it to an executable or shared library for
CPython to load. This was done even when embedding many modules into one
(the &#8220;deep&#8221; compilation mode, option <code class="docutils literal notranslate"><span class="pre">--deep</span></code>).</p>
<p>This was simple to do and in theory ought to allow the compiler to do
the most optimization. But for large programs, the resulting source code
could have exponential compile time behavior in the C++ compiler. At
least for the GNU g++ this was the case, others probably as well. This
is of course at the end a scalability issue of Nuitka, which now has
been addressed.</p>
<p>So the major advancement of this release is to make the <code class="docutils literal notranslate"><span class="pre">--deep</span></code>
option useful. But also there have been a performance improvements,
which end up giving us another boost for the &#8220;PyStone&#8221; benchmark.</p>
<section id="bug-fixes">
<h2>Bug fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this heading">&#61633;</a></h2>
<ul class="simple">
<li><p>Imports of modules local to packages now work correctly, closing the
small compatibility gap that was there.</p></li>
<li><p>Modules with a &#8220;-&#8221; in their name are allowed in CPython through
dynamic imports. This lead to wrong C++ code created. (Thanks to Li
Xuan Ji for reporting and submitting a patch to fix it.)</p></li>
<li><p>There were warnings about wrong format used for <code class="docutils literal notranslate"><span class="pre">Ssize_t</span></code> type of
CPython. (Again, thanks to Li Xuan Ji for reporting and submitting
the patch to fix it.)</p></li>
<li><p>When a wrong exception type is raised, the traceback should still be
the one of the original one.</p></li>
<li><p>Set and dict contractions (Python 2.7 features) declared local
variables for global variables used. This went unnoticed, because
list contractions don&#8217;t generate code for local variables at all, as
they cannot have such.</p></li>
<li><p>Using the <code class="docutils literal notranslate"><span class="pre">type()</span></code> built-in to create a new class could attribute
it to the wrong module, this is now corrected.</p></li>
</ul>
</section>
<section id="new-features">
<h2>New Features<a class="headerlink" href="#new-features" title="Permalink to this heading">&#61633;</a></h2>
<ul class="simple">
<li><p>Uses Scons to execute the actual C++ build, giving some immediate
improvements.</p></li>
<li><p>Now caches build results and Scons will only rebuild as needed.</p></li>
<li><p>The direct use of <code class="docutils literal notranslate"><span class="pre">__import__()</span></code> with a constant module name as
parameter is also followed in &#8220;deep&#8221; mode. With time, non-constants
may still become predictable, right now it must be a real CPython
constant string.</p></li>
</ul>
</section>
<section id="optimization">
<h2>Optimization<a class="headerlink" href="#optimization" title="Permalink to this heading">&#61633;</a></h2>
<ul class="simple">
<li><p>Added optimization for the built-ins <code class="docutils literal notranslate"><span class="pre">ord()</span></code> and <code class="docutils literal notranslate"><span class="pre">chr()</span></code>, these
require a module and built-in module lookup, then parameter parsing.
Now these are really quick with Nuitka.</p></li>
<li><p>Added optimization for the <code class="docutils literal notranslate"><span class="pre">type()</span></code> built-in with one parameter. As
above, using from builtin module can be very slow. Now it is
instantaneous.</p></li>
<li><p>Added optimization for the <code class="docutils literal notranslate"><span class="pre">type()</span></code> built-in with three parameters.
It&#8217;s rarely used, but providing our own variant, allowed to fix the
bug mentioned above.</p></li>
</ul>
</section>
<section id="cleanups">
<h2>Cleanups<a class="headerlink" href="#cleanups" title="Permalink to this heading">&#61633;</a></h2>
<ul class="simple">
<li><p>Using scons is a big cleanup for the way how C++ compiler related
options are applied. It also makes it easier to re-build without
Nuitka, e.g. if you were using Nuitka in your packages, you can
easily build in the same way than Nuitka does.</p></li>
<li><p>Static helpers source code has been moved to &#8220;.hpp&#8221; and &#8220;.cpp&#8221; files,
instead of being in &#8220;.py&#8221; files. This makes C++ compiler messages
more readable and allows us to use C++ mode in Emacs etc., making it
easier to write things.</p></li>
<li><p>Generated code for each module ends up in a separate file per module
or package.</p></li>
<li><p>Constants etc. go to their own file (although not named sensible yet,
likely going to change too)</p></li>
<li><p>Module variables are now created by the <code class="docutils literal notranslate"><span class="pre">CPythonModule</span></code> node only
and are unique, this is to make optimization of these feasible. This
is a pre-step to module variable optimization.</p></li>
</ul>
</section>
<section id="new-tests">
<h2>New Tests<a class="headerlink" href="#new-tests" title="Permalink to this heading">&#61633;</a></h2>
<ul class="simple">
<li><p>Added &#8220;ExtremeClosure&#8221; from my Python quiz, it was not covered by
existing tests.</p></li>
<li><p>Added test case for program that imports a module with a dash in its
name.</p></li>
<li><p>Added test case for main program that starts with a dash.</p></li>
<li><p>Extended the built-in tests to cover <code class="docutils literal notranslate"><span class="pre">type()</span></code> as well.</p></li>
</ul>
</section>
<section id="organisational">
<h2>Organisational<a class="headerlink" href="#organisational" title="Permalink to this heading">&#61633;</a></h2>
<ul>
<li><p>There is now a new environment variable <code class="docutils literal notranslate"><span class="pre">NUITKA_SCONS</span></code> which should
point to the directory with the <code class="docutils literal notranslate"><span class="pre">SingleExe.scons</span></code> file for Nuitka.
The scons file could be named better, because it is actually one and
the same who builds extension modules and executables.</p></li>
<li><p>There is now a new environment variable <code class="docutils literal notranslate"><span class="pre">NUITKA_CPP</span></code> which should
point to the directory with the C++ helper code of Nuitka.</p></li>
<li><p>The script &#8220;create-environment.sh&#8221; can now be sourced (if you are in
the top level directory of Nuitka) or be used with eval. In either
case it also reports what it does.</p>
<div class="admonition-update admonition">
<p class="admonition-title">Update</p>
<p>The script has become obsolete now, as the environment variables
are no longer necessary.</p>
</div>
</li>
<li><p>To cleanup the many &#8220;Program.build&#8221; directories, there is now a
&#8220;clean-up.sh&#8221; script for your use. Can be handy, but if you use git,
you may prefer its clean command.</p>
<div class="admonition-update admonition">
<p class="admonition-title">Update</p>
<p>The script has become obsolete now, as Nuitka test executions now
by default delete the build results.</p>
</div>
</li>
</ul>
</section>
<section id="numbers">
<h2>Numbers<a class="headerlink" href="#numbers" title="Permalink to this heading">&#61633;</a></h2>
<p>python 2.6:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pystone</span><span class="p">(</span><span class="mf">1.1</span><span class="p">)</span> <span class="n">time</span> <span class="k">for</span> <span class="mi">50000</span> <span class="n">passes</span> <span class="o">=</span> <span class="mf">0.65</span>
<span class="n">This</span> <span class="n">machine</span> <span class="n">benchmarks</span> <span class="n">at</span> <span class="mf">76923.1</span> <span class="n">pystones</span><span class="o">/</span><span class="n">second</span>
</pre></div>
</div>
<p>Nuitka 0.3.4:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pystone</span><span class="p">(</span><span class="mf">1.1</span><span class="p">)</span> <span class="n">time</span> <span class="k">for</span> <span class="mi">50000</span> <span class="n">passes</span> <span class="o">=</span> <span class="mf">0.34</span>
<span class="n">This</span> <span class="n">machine</span> <span class="n">benchmarks</span> <span class="n">at</span> <span class="mi">147059</span> <span class="n">pystones</span><span class="o">/</span><span class="n">second</span>
</pre></div>
</div>
<p>This is 91% for 0.3.4, up from 80% before.</p>
</section>
</section>

<div class="section ablog__blog_comments">
  
  


<div class="section ablog__prev-next">
  <span class="ablog__prev">
    
    
    <a href="nuitka-pre-release-034pre1.html">
      
      <i class="fa fa-arrow-circle-left"></i>
      
      <span>Nuitka Pre-Release 0.3.4pre1</span>
    </a>
    
  </span>
  <span class="ablog__spacer">&#160;</span>
  <span class="ablog__next">
    
    
    <a href="python-float-quiz.html">
      <span>Quiz Question</span>
      
      <i class="fa fa-arrow-circle-right"></i>
      
    </a>
    
  </span>
</div>

  
  
</div>

           </div>
          </div>
          <footer>

  <hr>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Kay Hayen and Nuitka Contributors.</p>
  </div>

  
<div class="share-button-container">
    <div class="socialbutton-wrapper">

        <a href="https://twitter.com/share?url=https://nuitka.net/posts/nuitka-release-034.html&amp;hashtags=nuitka" target="_blank">
            <div class="socialbutton twitter">
                <p class="icon">
                    <img src="/_static/icon-twitter.png" width="24" height="24">
                </p>

                <p class="shares">share...</p>
            </div>
        </a>

        <a href="https://www.facebook.com/sharer.php?u=https://nuitka.net/posts/nuitka-release-034.html&amp;hashtag=%23nuitka" target="_blank">
            <div class="socialbutton facebook">
                <p class="icon">
                    <img src="/_static/icon-facebook.png" width="24" height="24">
                </p>

                <p class="shares">share...</p>
            </div>
        </a>

        <a href="http://www.reddit.com/submit?url=https://nuitka.net/posts/nuitka-release-034.html" target="_blank">
            <div class="socialbutton reddit">
                <p class="icon">
                    <img src="/_static/icon-reddit.png" width="24" height="24">
                </p>

                <p class="shares">share...</p>
            </div>
        </a>

        <details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 switcher-container">
            <summary class="sd-summary-title sd-card-header switcher-title">EN<div class="sd-summary-down docutils">
                    <svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewbox="0 0 24 24" aria-hidden="true">
                        <path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z">
                        </path>
                    </svg>
                </div>
                <div class="sd-summary-up docutils">
                    <svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewbox="0 0 24 24" aria-hidden="true">
                        <path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z">
                        </path>
                    </svg>
                </div>
            </summary>
            <div class="sd-summary-content sd-card-body switcher-body docutils">
                <blockquote>
                    <div>
                        <div><div class="line"><a class="reference external" href="/de_DE/posts/nuitka-release-034.html">DE</a></div>
                            <div class="line"><a class="reference external" href="/zh_CN/posts/nuitka-release-034.html">CN</a></div>
                            </div></div>
                </blockquote>
            </div>
        </details>
    </div>
</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  </body>
</html>