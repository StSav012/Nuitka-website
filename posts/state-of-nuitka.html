<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/">
    <link rel="icon" href="../_static/favicon.svg" type="image/svg+xml">
    <link rel="icon" href="../_static/favicon.png" sizes="32x32" type="image/png">
    <link rel="icon" href="../_static/favicon.ico" sizes="32x32" type="image/x-icon">
    <link rel="icon" href="../_static/apple-touch-icon-iphone.png" sizes="57x57" type="image/png">
    <link rel="icon" href="../_static/apple-touch-icon-ipad.png" sizes="72x72" type="image/png">
    <link rel="icon" href="../_static/apple-touch-icon-iphone4.png" sizes="114x114" type="image/png">
    <link rel="icon" href="../_static/apple-touch-icon-ipad3.png" sizes="144x144" type="image/png">
    <link rel="apple-touch-icon" href="../_static/apple-touch-icon-180x180.png" sizes="180x180" type="image/png">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>State of Nuitka &#8212; Nuitka the Python Compiler  documentation</title>
      <link rel="stylesheet" href="/_static/css/combined_48888c5015cd786ba30be2ae5a8ec195.css" type="text/css">
      <link rel="canonical" href="https://nuitka.net/posts/state-of-nuitka.html">
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script>var DOCUMENTATION_OPTIONS = {
    URL_ROOT: '../',
    VERSION: '',
    LANGUAGE: 'None',
    COLLAPSE_INDEX: false,
    BUILDER: 'html',
    FILE_SUFFIX: '.html',
    LINK_SUFFIX: '.html',
    HAS_SOURCE: false,
    SOURCELINK_SUFFIX: '.txt',
    NAVIGATION_WITH_KEYS: false,
    SHOW_SEARCH_SUMMARY: true,
    ENABLE_SEARCH_SHORTCUTS: true,
};</script>
        <script src="/_static/combined_9d0826dfcf5ca364c4baefd34061e656.js" async=""></script>
        <link rel="index" title="Index" href="../genindex.html">
    <link rel="alternate" type="application/atom+xml" href="../blog/atom.xml" title="Nuitka Blog">
 
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../index.html" class="icon icon-home"> Nuitka the Python Compiler
            <div class="logo_container"><img src="../_static/Nuitka-Logo-Symbol.svg" class="logo" alt="Logo" width="208" height="209">
          </div></a><!-- Empty override file take the place of searchbox.html, which generates search box. -->
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/download.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/user-manual.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/support.html">Support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Commercial Users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/commercial.html">Nuitka Commercial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Release Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/Changelog.html">Nuitka Release 0.9 (Draft)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/Changelog.html#nuitka-release-0-8">Nuitka Release 0.8</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/Changelog.html#nuitka-release-0-7">Nuitka Release 0.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/Changelog.html#older-releases">Older Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/roadmap.html">Roadmap</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/developer-manual.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/api-doc.html">API doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/factory.html">Factory Instructions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Media</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pages/Presentations.html">Presentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/Streaming.html">Streaming</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/Credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/impressum.html">Impressum</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Under construction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/welcome.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/pyside2.html">Nuitka PySide2 support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/donations.html">Donations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/gsoc2019.html">Google Summer of Code 2019</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Nuitka the Python Compiler</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <!-- Empty override file take the place of sphinx_rtd_theme/breadcrumbs.html, which generates the top nav breadcrumbs. -->
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
              <section id="state-of-nuitka">
<h1><a class="toc-backref" href="#id1">State of Nuitka</a><a class="headerlink" href="#state-of-nuitka" title="Permalink to this headline">&#61633;</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#state-of-nuitka" id="id1">State of Nuitka</a></p>
<ul>
<li><p><a class="reference internal" href="#c-ish-vs-c-ish" id="id2">C-ish vs. C++-ish</a></p></li>
<li><p><a class="reference internal" href="#rewriting-code-generation" id="id3">Rewriting Code Generation</a></p></li>
<li><p><a class="reference internal" href="#current-situation" id="id4">Current Situation</a></p></li>
<li><p><a class="reference internal" href="#open-points" id="id5">Open Points</a></p></li>
<li><p><a class="reference internal" href="#other-things" id="id6">Other Things</a></p></li>
<li><p><a class="reference internal" href="#call-for-help" id="id7">Call for Help</a></p></li>
<li><p><a class="reference internal" href="#final-words" id="id8">Final Words</a></p></li>
</ul>
</li>
</ul>
</div>
<p>For quite some time, publicly, very little has happened with my Python
compiler Nuitka. But that doesn&#8217;t mean, there hasn&#8217;t been progress. In
fact it is tremendous. I would like to have a post that kind of
summarizes, what happened.</p>
<p>The last release, 0.5.1 was more of a maintenance release than making
real changes. It turns out, that the bigger changes got delayed by a
feature that I have described as &#8220;C-ish&#8221;. Let me outline, what this
means.</p>
<section id="c-ish-vs-c-ish">
<h2><a class="toc-backref" href="#id2">C-ish vs. C++-ish</a><a class="headerlink" href="#c-ish-vs-c-ish" title="Permalink to this headline">&#61633;</a></h2>
<p>When I started working on Nuitka, the big question was if it is possible
to create a sufficiently compatible compiler. The use of C++11 then,
together with some templates made it easy to cover a wide, wide part of
the language, and to fully integrate with CPython for compatibility.</p>
<p>The main goal was to get it going to work correctly. As time went on,
execution order demanded to do away with variadic templates, raw strings
were not all that perfect at all, and so C++-03 was good enough at one
point.</p>
<p>And then, as Nuitka became less and less template based, and shoving
more things into the node tree, and re-formulations, making this where
the knowledge resided. It became more and more obvious that C++ has two
problems. One in the way I used it. One inherent in the language typical
implementations:</p>
<ul class="simple">
<li><p>C++ exceptions are god damn slow</p></li>
<li><p>Everything should be a in a single statement.</p></li>
</ul>
<p>The later was my choice. Initially it made it easy to pass on references
and put the releasing C++ class around every expression as necessary.
Identifier classes were allowing for code generation to avoid taking
references where necessary, and it was not all that bad. Yet limiting.</p>
<p>This led to a couple of issues.</p>
<ul class="simple">
<li><p>The order of call arguments release for e.g. <code class="docutils literal notranslate"><span class="pre">f(g(h()))</span></code> was not
completely compatible, with the way how CPython does it. C++
destructors for objects living in a single statement didn&#8217;t give
sufficient control, and make the order and timing of finalization not
compatible.</p></li>
<li><p>The generated C++ code complexity became large. The compilation of
the generated C++ in some cases was huge. To the point, that e.g.
&#8220;code too complex&#8221; was giving by compilers like MSVC for some
modules.</p></li>
<li><p>Cases of in-place assignments were discovered, where CPython
outperforms Nuitka by a large margin. But these don&#8217;t fit into that
style of code generation.</p></li>
</ul>
<p>So, at some point, the pain had built up. Code generation was already
lighter than in the beginning. For example, initially <code class="docutils literal notranslate"><span class="pre">with</span></code>
statements had dedicated code templates to them. This, and many other
things, are long gone.</p>
<p>I took a deep dive, and <strong>rewrote</strong> the whole code generation, to be
much more &#8220;C-ish&#8221; than &#8220;C++-ish&#8221;. A huge undertaking that would take
months.</p>
<ul class="simple">
<li><p>Where previously, code didn&#8217;t have to handle return error codes (a
C++ exception was thrown), now everything needed a return value name,
and error check.</p></li>
<li><p>Where classes were previously conviently made sure things happened at
function or scope exit, manual handling needed to be added.</p></li>
<li><p>The handling of <code class="docutils literal notranslate"><span class="pre">continue</span></code>, <code class="docutils literal notranslate"><span class="pre">break</span></code>, and <code class="docutils literal notranslate"><span class="pre">return</span></code> was
previously done with exceptions being thrown, if they were to pass a
<code class="docutils literal notranslate"><span class="pre">try</span></code>/<code class="docutils literal notranslate"><span class="pre">finally</span></code> handler. Now these are done with stacks of exit
handlers, where <code class="docutils literal notranslate"><span class="pre">goto</span></code> statements are used to produce the correct
behaviour.</p></li>
</ul>
</section>
<section id="rewriting-code-generation">
<h2><a class="toc-backref" href="#id3">Rewriting Code Generation</a><a class="headerlink" href="#rewriting-code-generation" title="Permalink to this headline">&#61633;</a></h2>
<p>Redoing code generation, over months, while ultimately, slowly, arriving
at a point where Nuitka would be doing this, it already did before, was
kind of frustrating.</p>
<p>Of course, the performance benefit would be there, but it would not be
all that much, except for exception raising and handling. There it would
be huge. Ultimately for PyStone, a couple of extra percents were gained.</p>
<p>This really was a point, where I felt, that Nuitka will make it or
break. And for a long time, I honestly wasn&#8217;t so sure, that I pull
through. But I did.</p>
</section>
<section id="current-situation">
<h2><a class="toc-backref" href="#id4">Current Situation</a><a class="headerlink" href="#current-situation" title="Permalink to this headline">&#61633;</a></h2>
<p>The current pre-release is release quality. You should try it out, it&#8217;s
great.</p>
<ul class="simple">
<li><p>There are many changes to Standalone mode. Due to changes in how
constants are now created in the modules that uses them, instead of
everything globally, the parallel compilation now works great. What
previously took an hour with MSVC (the problem child, gcc was always
relatively good), now takes minutes only.</p></li>
<li><p>The support for virtualenv&#8217;s of all kinds seems to work on Windows,
Linux, and macOS, which all seem to have different kinds of codes.</p></li>
<li><p>The support for macOS is now there. Thanks to a virtual server month
donated to Jarrad Hope, I was able to iron issues out.</p></li>
<li><p>The final release will also work with standalone binaries created on
Fedora 20 which got hard code rpaths removed on the factory git
branch.</p></li>
</ul>
<p>And yet, I am not yet releasing. In fact, I would like to ask you to
give it a roll, and integrate test feedback.</p>
<p>Although more tests than ever are executed and pass, (e.g. the Mercurial
test suite is now run each time I make a commit, and fully identically
passes or fails the test suite with the current Mercurial code), there
can never be enough.</p>
<p>The changes I made are the most intense ever, and definitely have
potential for regressions. I am used to providing very high quality
releases.</p>
<p>Also, I am working on the Buildbot instances to automate the production
of <a class="reference external" href="https://speedcenter.nuitka.net">performance graphs</a>, which get
updated fully automatically. I am working on updating the downloads page
automatically for each release that gets made.</p>
<p>And generally, I am trying to improve my work flow, to make it easier to
push out releases with less effort. Buildbot should drive the release
process more completely. I am using the git flow to provide hot-fixes,
and this should be even less painful in the future.</p>
</section>
<section id="open-points">
<h2><a class="toc-backref" href="#id5">Open Points</a><a class="headerlink" href="#open-points" title="Permalink to this headline">&#61633;</a></h2>
<p>With this release, presenting great progress, many things remain in an
unfinished state.</p>
<ul>
<li><p>The support for Python3.4 is not complete. Most things work, but some
need more work. Specifically the changes to <code class="docutils literal notranslate"><span class="pre">__class__</span></code> variable
closure taking, need another major refactoring, this time on variable
handling.</p>
<p>Currently there are variables, closure variables, temp variables, and
then temp variable references. The way they work is different. One
way they work different, prevents a temp variable closure reference
to carry a name, in that case <code class="docutils literal notranslate"><span class="pre">-_class__</span></code>, which would be needed
for Python3.4, where that is suddenly necessary.</p>
<p>With this done, the SSA code will be even easier to write, as temp
variables and named variables will finally be fully unified.</p>
</li>
<li><p>The use of C++ classes is largely reduced now. But a few still
remain, namely for local variables, closure variables, and temp
variables that are explicit variables. They still use C++ classes,
although changing that seems quite possible now, because at least for
temporary variables, the class doesn&#8217;t do anything in terms of code
anymore.</p>
<p>Removing these classes may well gain more performance.</p>
</li>
<li><p>Now that code generation can more easily make a difference, and SSA
apparently is becoming reliable, it could be used to <em>know</em> that
values must be value and to optimize checks away.</p>
<p>Currently every variable access checks for &#8220;NULL&#8221;, when it&#8217;s part of
an assign trace. Some optimizations exist for parameter variables
without <code class="docutils literal notranslate"><span class="pre">del</span></code> on them, that do not use SSA.</p>
<p>This could be expanded and made general, allowing for much less code
to be generated (specifically avoiding error code, and release code
for variables that cannot give an error).</p>
</li>
<li><p>The SSA has been found unreliable in some instances, due to bugs that
I believe I found. We could attempt and forward propagate variable
assignments to where they are used, eliminating variables, etc.</p>
<p>This is a place, where a lot of performance can be gained. We really
want to be there. And &#8220;C-ish&#8221; now makes this ever more attractive,
despite the large delay in time it has caused.</p>
</li>
<li><p>The in-place assignment code for strings, where CPython can be way
faster than current Nuitka, it bears a risk of getting it wrong. It
is therefore pushed to a future release.</p></li>
</ul>
</section>
<section id="other-things">
<h2><a class="toc-backref" href="#id6">Other Things</a><a class="headerlink" href="#other-things" title="Permalink to this headline">&#61633;</a></h2>
<p>For the website, I am relocating the virtual machine to a dedicated
server rented for an increased price. This will allow to add a few more
dynamic features, as the virtual machine was always too limited in RAM.
It&#8217;s more expensive, but I feel a better investment of my time.</p>
<p>As mentioned before, I am not going to conferences this year. Enjoy
Europython, and consider having a Lightning talk about Nuitka. I will be
there next year again.</p>
</section>
<section id="call-for-help">
<h2><a class="toc-backref" href="#id7">Call for Help</a><a class="headerlink" href="#call-for-help" title="Permalink to this headline">&#61633;</a></h2>
<ul class="simple">
<li><p>Please test the latest release of Nuitka.</p></li>
<li><p>Please consider <a class="reference external" href="/pages/donations.html">making a donation</a> to support my work on
Nuitka. I have continuous monthly costs of it, so it would be sweet
if it&#8217;s with all my time spent working on it, at least not a
financial cost to me.</p></li>
<li><p>Please join the mailing list (since closed), and offer your help with
tasks. Nuitka can seriously take more people developing, testing,
reviewing, and quality checking it.</p></li>
</ul>
</section>
<section id="final-words">
<h2><a class="toc-backref" href="#id8">Final Words</a><a class="headerlink" href="#final-words" title="Permalink to this headline">&#61633;</a></h2>
<p>So, there is this &#8220;C-ish&#8221; release 0.5.2 cooking. You are invited to
help. Big, improvements are coming to Nuitka. Even after this next huge
release, very important work is still open, but hope is to have this
complete over the summer.</p>
<div class="line-block">
<div class="line">Yours,</div>
<div class="line">Kay</div>
</div>
</section>
</section>

<div class="section">
    

<div class="section">
  <span style="float: left">
     
    <a href="try-finally-python-quiz.html">
      <i class="fa fa-arrow-circle-left"></i> Try Finally Python Quiz
    </a>
    
  </span>
  <span>&#160;</span>
  <span style="float: right">
     
    <a href="yup-another-python-riddle.html">
      Yup, another Python Quiz <i class="fa fa-arrow-circle-right"></i>
    </a>
    
  </span>
</div>
  
</div>

           </div>
          </div>
          <footer>

  <hr>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Kay Hayen and Nuitka Contributors.</p>
  </div>

  
<div class="share-button-container">
    <div class="socialbutton-wrapper">

        <a href="https://twitter.com/share?url=https://nuitka.net/posts/state-of-nuitka.html&amp;hashtags=nuitka" target="_blank">
            <div class="socialbutton twitter">
                <p class="icon">
                    <img src="/_static/icon-twitter.png" width="24" height="24">
                </p>

                <p class="shares">share...</p>
            </div>
        </a>

        <a href="https://www.facebook.com/sharer.php?u=https://nuitka.net/posts/state-of-nuitka.html&amp;hashtag=%23nuitka" target="_blank">
            <div class="socialbutton facebook">
                <p class="icon">
                    <img src="/_static/icon-facebook.png" width="24" height="24">
                </p>

                <p class="shares">share...</p>
            </div>
        </a>

        <a href="http://www.reddit.com/submit?url=https://nuitka.net/posts/state-of-nuitka.html" target="_blank">
            <div class="socialbutton reddit">
                <p class="icon">
                    <img src="/_static/icon-reddit.png" width="24" height="24">
                </p>

                <p class="shares">share...</p>
            </div>
        </a>

        <details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3 switcher-container">
            <summary class="sd-summary-title sd-card-header switcher-title">EN<div class="sd-summary-down docutils">
                    <svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewbox="0 0 24 24" aria-hidden="true">
                        <path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z">
                        </path>
                    </svg>
                </div>
                <div class="sd-summary-up docutils">
                    <svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewbox="0 0 24 24" aria-hidden="true">
                        <path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z">
                        </path>
                    </svg>
                </div>
            </summary>
            <div class="sd-summary-content sd-card-body switcher-body docutils">
                <blockquote>
                    <div>
                        <div><div class="line"><a class="reference external" href="/zh_CN/posts/state-of-nuitka.html">CN</a></div>
                            <div class="line"><a class="reference external" href="/de_DE/posts/state-of-nuitka.html">DE</a></div>
                            </div></div>
                </blockquote>
            </div>
        </details>
    </div>
</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  </body>
</html>